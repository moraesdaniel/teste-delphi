unit uFuncoesTest;
{

  Delphi DUnit Test Case
  ----------------------
  This unit contains a skeleton test case class generated by the Test Case Wizard.
  Modify the generated code to correctly setup and call the methods from the unit 
  being tested.

}

interface

uses
  TestFramework, System.StrUtils, uFuncoes, System.SysUtils, System.Math;

type
  // Test methods for class TFuncoes

  TestTFuncoes = class(TTestCase)
  strict private
    FFuncoes: TFuncoes;
  public
    procedure SetUp; override;
    procedure TearDown; override;
  published
    procedure TestCalcularINSS;
    procedure TestCalcularIR;
  end;

implementation

procedure TestTFuncoes.SetUp;
begin
  FFuncoes := TFuncoes.Create;
end;

procedure TestTFuncoes.TearDown;
begin
  FFuncoes.Free;
  FFuncoes := nil;
end;

procedure TestTFuncoes.TestCalcularINSS;
var
  ReturnValue: Double;
  dPercINSS: Double;
  dSalario: Double;
  dValorEsperado: Double;
begin
  dSalario := 1865.70;
  dPercINSS := 8;
  dValorEsperado := 149.26;
  ReturnValue := FFuncoes.CalcularINSS(dSalario, dPercINSS);
  Check(ReturnValue = dValorEsperado, 'Esperado: '+FloatToStr(dValorEsperado)+
    ' / Resultado: '+FloatToStr(ReturnValue));
end;

procedure TestTFuncoes.TestCalcularIR;
var
  ReturnValue: Double;
  dValorDeducao: Double;
  dPercIR: Double;
  dSalario: Double;
  iQtdDependentesIR: Integer;
begin
  dValorDeducao := 50;
  dPercIR := 15;
  dSalario := 1865.70;
  iQtdDependentesIR := 3;
  ReturnValue := FFuncoes.CalcularIR(iQtdDependentesIR, dSalario, dPercIR, dValorDeducao);
  CheckEquals(ReturnValue, 257.36, 'O IR está correto');
end;

initialization
  // Register any test cases with the test runner
  RegisterTest(TestTFuncoes.Suite);
end.

